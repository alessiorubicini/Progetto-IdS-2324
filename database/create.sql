CREATE TABLE User(
	ID INTEGER PRIMARY KEY AUTO_INCREMENT,
	name VARCHAR(30) NOT NULL,
	surname VARCHAR(30) NOT NULL,
	fiscalCode VARCHAR(16) UNIQUE NOT NULL,
	email VARCHAR(30) UNIQUE NOT NULL,
	password VARCHAR(30) NOT NULL
);

CREATE TABLE Participation(
	userId INTEGER NOT NULL REFERENCES User.ID,
	cityId INTEGER NOT NULL REFERENCES City.ID,
	roleId INTEGER NOT NULL REFERENCES Role.ID
);

CREATE TABLE City(
	ID INTEGER PRIMARY KEY AUTO_INCREMENT,
	cadastralCode VARCHAR(4) UNIQUE,
	name VARCHAR(30) NOT NULL,
	region VARCHAR(30) NOT NULL,
	province VARCHAR(30) NOT NULL,
	istatCode INTEGER UNIQUE
);

CREATE TABLE Point(
	ID INTEGER PRIMARY KEY AUTO_INCREMENT,
	name VARCHAR(30) NOT NULL,
	description VARCHAR(30),
	longitude FLOAT NOT NULL,
	latitude FLOAT NOT NULL,
	altitude FLOAT NOT NULL,
	imagePath VARCHAR(50),
	cityId INTEGER NOT NULL REFERENCES City.ID
);

CREATE TABLE Contest(
	ID INTEGER PRIMARY KEY AUTO_INCREMENT,
	title VARCHAR(30) NOT NULL,
	description VARCHAR(30),
	publicationDate DATETIME NOT NULL,
	closingDate DATETIME NOT NULL,
	animatorId INTEGER NOT NULL REFERENCES User.ID,
	cityId INTEGER NOT NULL REFERENCES City.ID ,
	winnerId INTEGER REFERENCES User.ID
);

CREATE TABLE Content(
	ID INTEGER PRIMARY KEY AUTO_INCREMENT,
	title VARCHAR(30) NOT NULL,
	description VARCHAR(30) NOT NULL,
	date DATETIME NOT NULL,
	pointId INTEGER NOT NULL REFERENCES Point.ID,
	statusId INTEGER NOT NULL REFERENCES ContentStatus.ID,
	mediaId INTEGER REFERENCES Media.ID,
	contestId INTEGER REFERENCES Contest.ID
);

CREATE TABLE Media(
	ID INTEGER PRIMARY KEY AUTO_INCREMENT,
	name VARCHAR(30) NOT NULL,
	path VARCHAR(50) NOT NULL
);

CREATE TABLE Role(
	ID INTEGER PRIMARY KEY AUTO_INCREMENT,
	title VARCHAR(30) NOT NULL UNIQUE,
	description VARCHAR(30) NOT NULL
);

CREATE TABLE ContentStatus(
	ID INTEGER PRIMARY KEY AUTO_INCREMENT,
	name VARCHAR(30) NOT NULL UNIQUE
);

CREATE TABLE SystemProblemReport(
	ID INTEGER PRIMARY KEY AUTO_INCREMENT,
	title VARCHAR(30) NOT NULL,
	description VARCHAR(30),
	date DATETIME NOT NULL,
	version VARCHAR(30) NOT NULL,
	instructions VARCHAR(100) NOT NULL,
	userId INTEGER NOT NULL REFERENCES User.ID
);

CREATE TABLE ContenReport(
	ID INTEGER PRIMARY KEY AUTO_INCREMENT,
	description VARCHAR(30) NOT NULL,
	date DATETIME NOT NULL,
	userId INTEGER NOT NULL REFERENCES User.ID,
	contentId INTEGER NOT NULL REFERENCES Content.ID
);

CREATE TABLE RoleChangeRequest(
	ID INTEGER PRIMARY KEY AUTO_INCREMENT,
	description VARCHAR(30) NOT NULL,
	date DATETIME NOT NULL,
	userId INTEGER NOT NULL REFERENCES User.ID,
	requiredRoleId INTEGER NOT NULL REFERENCES Role.ID,
	cityId INTEGER NOT NULL REFERENCES City.ID ,
	statusId INTEGER NOT NULL REFERENCES RequestStatus.ID
);

CREATE TABLE RequestStatus(
	ID INTEGER PRIMARY KEY AUTO_INCREMENT,
	type VARCHAR(30) NOT NULL
);